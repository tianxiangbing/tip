!function(t,i){"function"==typeof define&&define.amd?define("tip",["$"],i):"object"==typeof exports?module.exports=i():t.Tip=i(window.Zepto||window.jQuery||$)}(this,function(t){function i(){var t=Math.random().toString().replace(".","");this.id="Tip_"+t}return t.fn.Tip=function(s){var o=[];return t(this).each(function(){var e=t.extend({trigger:this},s),n=new i;n.init(e),o.push(n)}),t(o)},i.prototype={init:function(i){this.settings=t.extend({trigger:"",status:"hide",callback:null,tpl:'<div class="ui-tip"><div class="ui-tip-content"></div><div class="ui-tip-arrow"><i></i><em></em></div></div>',triggerEvent:"hover",offset:{x:0,y:0},width:"auto",height:"auto",zIndex:999,content:"",inViewport:!0,delegate:null,position:"right",ajax:null},i),this.status=this.settings.status,this._getPos(),this.bindEvent()},_getPos:function(){this.position=this.settings.position.split("|")[0],this.arrowPosition=this.settings.position.split("|")[1]||"center"},bindEvent:function(){var i=this,s=this.settings.delegate,o=this.settings.trigger;if(s||(s=this.settings.trigger,o=null),"click"==this.settings.triggerEvent)t(s).on(this.settings.triggerEvent,o,function(){"hide"==i.status?i.show():"show"==i.status&&i.hide()});else if("hover"==this.settings.triggerEvent){var e=null;t(s).on("mouseover",o,function(){i.show(),t(i.tip).hover(function(){clearTimeout(e)},function(){i.hide()})}).on("mouseout",o,function(){e=setTimeout(function(){i.hide()},500)})}else this.settings.triggerEvent&&t(this.settings.trigger).on(this.settings.triggerEvent,function(){i.show()})},show:function(){var i=this;this.settings.beforeShow&&this.settings.beforeShow.call(this),this.tip||(this.tip=t(this.settings.tpl),this.tipcontent=this.tip.find(".ui-tip-content"),this.tiparrow=this.tip.find(".ui-tip-arrow"),t("body").append(this.tip),this.tip.on("hide",function(){i.hide()})),this.tip.show().css({zIndex:this.settings.zIndex}),this.tipcontent.css({height:this.settings.height,width:this.settings.width}),this.setContent(this.settings.content),this.settings.ajax&&this.settings.ajax().done(function(t){i.setContent(t)}),this.setPosition(),this.status="show",this.start(),this.settings.callback&&this.settings.callback.call(this)},hide:function(){t(this.tip).remove(),this.tip=null,this.status="hide",this.stop(),this.b=!1,this._getPos(),this.settings.afterHide&&this.settings.afterHide.call(this)},start:function(){var i=this;t(window).resize(function(){i._getPos(),i.b=!1,i.setPosition()}).scroll(function(){i._getPos(),i.b=!1,i.setPosition()}),this._timer&&clearInterval(this._timer),this._timer=setInterval(function(){i.setPosition()},1e3)},setPosition:function(){var i=(this.b,this);if(this.tip&&0!=this.tip.size()){var s=t(i.settings.trigger).offset(),o={h:t(i.settings.trigger).outerHeight(),w:t(i.settings.trigger).outerWidth()},e={w:this.tip.outerWidth(),h:this.tip.outerHeight()};switch(this.tip.attr("class","ui-tip"),i.position){case"left":var n=0,h=0;"top"==this.arrowPosition?(n=+i.settings.offset.y,h=10):"bottom"==this.arrowPosition?(n=i.settings.offset.y-e.h+o.h,h=e.h-22):(n=i.settings.offset.y-(e.h-o.h)/2,h=e.h/2-6),this.tiparrow.y=h,this.tiparrow.x=e.w-2,this.tip.x=s.left-e.w+i.settings.offset.x-10,this.tip.y=s.top+i.settings.offset.y+n,this.tip.addClass("arrow-left"),this._overScreen();break;case"top":var r=0,p=0;"left"==this.arrowPosition?(r=0,p=10):"right"==this.arrowPosition?(r=+o.w-e.w,p=e.w-22):(r=-(e.w-o.w)/2,p=e.w/2-6),this.tiparrow.y=e.h-2,this.tiparrow.x=p,this.tip.x=s.left+r,this.tip.y=s.top-e.h+i.settings.offset.y-10,this.tip.addClass("arrow-top"),this._overScreen();break;case"bottom":var r=0,p=0;"left"==this.arrowPosition?(r=0,p=10):"right"==this.arrowPosition?(r=+o.w-e.w,p=e.w-22):(r=-(e.w-o.w)/2,p=e.w/2-6),this.tiparrow.y=-6,this.tiparrow.x=p,this.tip.x=s.left+r,this.tip.y=s.top+o.h+i.settings.offset.y+10,this.tip.addClass("arrow-bottom"),this._overScreen();break;default:var n=0,h=0;"top"==this.arrowPosition?(n=+i.settings.offset.y,h=10):"bottom"==this.arrowPosition?(n=i.settings.offset.y-e.h+o.h,h=e.h-22):(n=i.settings.offset.y-(e.h-o.h)/2,h=e.h/2-6),this.tip.x=o.w+s.left+i.settings.offset.x+10,this.tip.y=s.top+n,this.tip.addClass("arrow-right"),this.tiparrow.y=h,this.tiparrow.x=-6,this._overScreen()}this.settings.inViewport||this._setPosition()}},stop:function(){clearInterval(this._timer),t(window).off("resize").off("scroll")},_overScreen:function(){var i={y:t(window).scrollTop(),x:t(window).scrollLeft()},s={w:t(window).width(),h:t(window).height()};this.settings.inViewport&&!this.b&&(this.b=!0,this.tip.x-i.x<0&&("left"==this.position?this.position="right":this.arrowPosition="left"),this.tip.y<i.y&&("top"==this.position?this.position="bottom":this.arrowPosition="top"),this.tip.y+this.tip.outerHeight()>s.h+i.y&&("bottom"==this.position?this.position="top":this.arrowPosition="bottom"),this.tip.x+this.tip.outerWidth()>i.x+s.w&&("right"==this.position?this.position="left":this.arrowPosition="right"),this.setPosition()),this._setPosition()},_setPosition:function(){this.tip.css({left:this.tip.x,top:this.tip.y}),this.tiparrow.css({top:this.tiparrow.y,left:this.tiparrow.x})},setContent:function(t){this.tipcontent.html(t),this.setPosition()}},i});