!function(t,i){"function"==typeof define&&define.amd?define(["$"],i):"object"==typeof exports?module.exports=i():t.Tip=i(window.Zepto||window.jQuery||$)}(this,function(g){function e(){var t=Math.random().toString().replace(".","");this.id="Tip_"+t}return g.fn.Tip=function(s){var o=[];return g(this).each(function(){var t=g.extend({trigger:this},s),i=new e;i.init(t),o.push(i)}),g(o)},e.prototype={init:function(t){this.settings=g.extend({trigger:"",status:"hide",callback:null,tpl:'<div class="ui-tip"><div class="ui-tip-content"></div><div class="ui-tip-arrow"><i></i><em></em></div></div>',triggerEvent:"hover",offset:{x:0,y:0},width:"auto",height:"auto",zIndex:999,content:"",inViewport:!0,delegate:null,position:"right",ajax:null},t),this.status=this.settings.status,this._getPos(),this.bindEvent()},_getPos:function(){this.position=this.settings.position.split("|")[0],this.arrowPosition=this.settings.position.split("|")[1]||"center"},bindEvent:function(){var i=this,t=this.settings.delegate,s=this.settings.trigger;if(t||(t=this.settings.trigger,s=null),"click"==this.settings.triggerEvent)g(t).on(this.settings.triggerEvent,s,function(t){i.settings.trigger=this,"hide"==i.status?i.show():"show"==i.status&&i.hide(),t.stopPropagation()});else if("hover"==this.settings.triggerEvent){var o=null;g(t).on("mouseover",s,function(){i.show(),g(i.tip).hover(function(){clearTimeout(o)},function(){i.hide()})}).on("mouseout",s,function(){o=setTimeout(function(){i.hide()},500)})}else this.settings.triggerEvent&&g(this.settings.trigger).on(this.settings.triggerEvent,function(){i.show()})},show:function(){var i=this;this.settings.beforeShow&&this.settings.beforeShow.call(this),this.tip||(this.tip=g(this.settings.tpl),this.tipcontent=this.tip.find(".ui-tip-content"),this.tiparrow=this.tip.find(".ui-tip-arrow"),g("body").append(this.tip),this.tip.on("hide",function(){i.hide()})),this.tip.show().css({zIndex:this.settings.zIndex}),this.tipcontent.css({height:this.settings.height,width:this.settings.width}),this.setContent(this.settings.content),this.settings.ajax&&this.settings.ajax(this.settings.trigger).done(function(t){i.setContent(t)}),this.setPosition(),this.initPos={x:this.tip.x,y:this.tip.y},this.status="show",this.start(),this.settings.callback&&this.settings.callback.call(this)},hide:function(){g(this.tip).remove(),this.tip=null,this.status="hide",this.stop(),this.b=!1,this._getPos(),this.settings.afterHide&&this.settings.afterHide.call(this)},start:function(){var t=this;g(window).resize(function(){t._getPos(),t.b=!1,t.setPosition()}).scroll(function(){t._getPos(),t.b=!1,t.setPosition()}),this._timer&&clearInterval(this._timer),this._timer=setInterval(function(){10<Math.abs(t.tip.y-t.initPos.y)||10<Math.abs(t.tip.x-t.initPos.x)?t.hide():t.setPosition()},100)},setPosition:function(){this.b;var t=this;if(this.tip&&0!=this.tip.size()){if(0==g(this.settings.trigger).filter(":visible").size())return this.tip.hide(),!1;this.tip&&this.tip.show();var i=g(t.settings.trigger).offset(),s=g(t.settings.trigger).outerHeight(),o=g(t.settings.trigger).outerWidth(),e=this.tip.outerWidth(),n=this.tip.outerHeight();switch(this.tip.attr("class","ui-tip"),t.position){case"left":var h=0,r=0;"top"==this.arrowPosition?(h=+t.settings.offset.y,r=10):"bottom"==this.arrowPosition?(h=t.settings.offset.y-n+s,r=n-22):(h=t.settings.offset.y-(n-s)/2,r=n/2-6),this.tiparrow.y=r,this.tiparrow.x=e-2,this.tip.x=i.left-e+t.settings.offset.x-10,this.tip.y=i.top+t.settings.offset.y+h,this.tip.addClass("arrow-left"),this._overScreen();break;case"top":var p=0,a=0;"left"==this.arrowPosition?(p=0,a=10):"right"==this.arrowPosition?(p=+o-e,a=e-22):(p=-(e-o)/2,a=e/2-6),this.tiparrow.y=n-2,this.tiparrow.x=a,this.tip.x=i.left+t.settings.offset.x+p,this.tip.y=i.top-n+t.settings.offset.y-10,this.tip.addClass("arrow-top"),this._overScreen();break;case"bottom":p=0,a=0;"left"==this.arrowPosition?(p=0,a=10):"right"==this.arrowPosition?(p=+o-e,a=e-22):(p=-(e-o)/2,a=e/2-6),this.tiparrow.y=-6,this.tiparrow.x=a,this.tip.x=i.left+t.settings.offset.x+p,this.tip.y=i.top+s+t.settings.offset.y+10,this.tip.addClass("arrow-bottom"),this._overScreen();break;default:h=0,r=0;"top"==this.arrowPosition?(h=+t.settings.offset.y,r=10):"bottom"==this.arrowPosition?(h=t.settings.offset.y-n+s,r=n-22):(h=t.settings.offset.y-(n-s)/2,r=n/2-6),this.tip.x=o+i.left+t.settings.offset.x+10,this.tip.y=i.top+t.settings.offset.y+h,this.tip.addClass("arrow-right"),this.tiparrow.y=r,this.tiparrow.x=-6,this._overScreen()}this.settings.inViewport||this._setPosition()}},stop:function(){clearInterval(this._timer),g(window).off("resize").off("scroll")},_overScreen:function(){var t=g(window).scrollTop(),i=g(window).scrollLeft(),s=g(window).width(),o=g(window).height();this.settings.inViewport&&!this.b&&(this.b=!0,this.tip.x-i<0&&("left"==this.position?this.position="right":this.arrowPosition="left"),this.tip.y<t&&("top"==this.position?this.position="bottom":this.arrowPosition="top"),this.tip.y+this.tip.outerHeight()>o+t&&("bottom"==this.position?this.position="top":this.arrowPosition="bottom"),this.tip.x+this.tip.outerWidth()>i+s&&("right"==this.position?this.position="left":this.arrowPosition="right"),this.setPosition()),this._setPosition()},_setPosition:function(){this.tip.css({left:this.tip.x,top:this.tip.y}),this.tiparrow.css({top:this.tiparrow.y,left:this.tiparrow.x})},setContent:function(t){this.tipcontent.html(t),this.setPosition()}},e});