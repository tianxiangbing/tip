!function(t,i){"function"==typeof define&&define.amd?define(["$"],i):"object"==typeof exports?module.exports=i():t.Tip=i(window.Zepto||window.jQuery||$)}(this,function(a){function o(){var t=Math.random().toString().replace(".","");this.id="Tip_"+t}return a.fn.Tip=function(s){var e=[];return a(this).each(function(){var t=a.extend({trigger:this},s),i=new o;i.init(t),e.push(i)}),a(e)},o.prototype={init:function(t){this.settings=a.extend({trigger:"",status:"hide",callback:null,tpl:'<div class="ui-tip"><div class="ui-tip-content"></div><div class="ui-tip-arrow"><i></i><em></em></div></div>',triggerEvent:"hover",rightMouseTarget:void 0,offset:{x:0,y:0},width:"auto",height:"auto",zIndex:999,content:"",inViewport:!0,delegate:null,position:"right",ajax:null},t),this.status=this.settings.status,this._getPos(),this.bindEvent()},_getPos:function(){this.position=this.position||this.settings.position.split("|")[0],this.arrowPosition=this.settings.position.split("|")[1]||"center"},bindEvent:function(){var i=this,t=this.settings.delegate,s=this.settings.trigger;if(t||(t=this.settings.trigger,s=null),"click"==this.settings.triggerEvent)a(t).on(this.settings.triggerEvent,s,function(t){i.trigger=this,"hide"==i.status?i.show():"show"==i.status&&i.hide(),t.stopPropagation()});else if("hover"==this.settings.triggerEvent){var e=null;a(t).on("mouseover",s,function(){i.trigger=this,i.show(),a(i.tip).hover(function(){clearTimeout(e)},function(){i.hide()})}).on("mouseout",s,function(){i.trigger=this,e=setTimeout(function(){i.hide()},500)})}else this.settings.triggerEvent&&a(this.settings.trigger).on(this.settings.triggerEvent,function(){i.show()});this.settings.rightMouseTarget&&a(t).on("contextmenu",this.settings.rightMouseTarget,function(t){2==t.button&&(i.e=t,i.trigger=a(this).find(i.settings.trigger),"hide"==i.status?i.show():"show"==i.status&&i.hide(),t.stopPropagation(),t.preventDefault(),t.returnValue=!1,t.cancelBubble=!0)})},show:function(){var i=this;this.settings.beforeShow&&this.settings.beforeShow.call(this),this.tip||(this.tip=a(this.settings.tpl),this.tipcontent=this.tip.find(".ui-tip-content"),this.tiparrow=this.tip.find(".ui-tip-arrow"),a("body").append(this.tip),this.tip.on("hide",function(){i.hide()})),this.tip.show().css({zIndex:this.settings.zIndex}),this.tipcontent.css({height:this.settings.height,width:this.settings.width}),"function"==typeof this.settings.content?this.setContent(this.settings.content.call(this,this.settings.trigger)):this.setContent(this.settings.content),this.settings.ajax?this.settings.ajax(this.trigger).done(function(t){i.setContent(t),i.b=!1,i.status="show",i.start(),i.setPosition()}):(this.initPos={x:this.tip.x,y:this.tip.y},this.status="show",this.start(),this.setPosition()),this.settings.callback&&this.settings.callback.call(this)},hide:function(){a(this.tip).remove(),this.tip=void 0,this.position=void 0,this.status="hide",this.e=void 0,this.stop(),this.b=!1,this._getPos(),this.settings.afterHide&&this.settings.afterHide.call(this)},start:function(){var t=this;a(window).resize(function(){t._getPos(),t.b=!1,t.setPosition()}).scroll(function(){t._getPos(),t.setPosition()}),this._timer&&clearInterval(this._timer),this._timer=setInterval(function(){t.setPosition()},100)},setPosition:function(){this.b;var t=this;if(this.tip&&0!=this.tip.size()){if(0==a(this.settings.trigger).filter(":visible").size())return this.tip.hide(),!1;this.tip&&this.tip.show();var i=a(t.trigger).offset();this.settings.rightMouseTarget&&this.e&&"contextmenu"==this.e.type&&(i={left:this.e.pageX,top:this.e.pageY});var s=a(t.trigger).outerHeight(),e=a(t.trigger).outerWidth(),o=this.tip.outerWidth(),n=this.tip.outerHeight();switch(this.tip.attr("class","ui-tip"),t.position){case"left":var h=0,r=0;"top"==this.arrowPosition?(h=+t.settings.offset.y,r=10):"bottom"==this.arrowPosition?(h=t.settings.offset.y-n+s,r=n-22):(h=t.settings.offset.y-(n-s)/2,r=n/2-6),this.tiparrow.y=r,this.tiparrow.x=o-2,this.tip.x=i.left-o+t.settings.offset.x-10,this.tip.y=i.top+t.settings.offset.y+h,this.tip.addClass("arrow-left"),this._overScreen();break;case"top":var g=0,p=0;"left"==this.arrowPosition?(g=0,p=10):"right"==this.arrowPosition?(g=+e-o,p=o-22):(g=-(o-e)/2,p=o/2-6),this.tiparrow.y=n-2,this.tiparrow.x=p,this.tip.x=i.left+t.settings.offset.x+g,this.tip.y=i.top-n+t.settings.offset.y+10,this.tip.addClass("arrow-top"),this._overScreen();break;case"bottom":g=0,p=0;"left"==this.arrowPosition?(g=0,p=10):"right"==this.arrowPosition?(g=+e-o,p=o-22):(g=-(o-e)/2,p=o/2-6),this.tiparrow.y=-6,this.tiparrow.x=p,this.tip.x=i.left+t.settings.offset.x+g,this.tip.y=i.top+s+t.settings.offset.y+10,this.tip.addClass("arrow-bottom"),this._overScreen();break;default:h=0,r=0;"top"==this.arrowPosition?(h=+t.settings.offset.y,r=10):"bottom"==this.arrowPosition?(h=t.settings.offset.y-n+s,r=n-22):(h=t.settings.offset.y-(n-s)/2,r=n/2-6),this.tip.x=e+i.left+t.settings.offset.x+10,this.tip.y=i.top+t.settings.offset.y+h,this.tip.addClass("arrow-right"),this.tiparrow.y=r,this.tiparrow.x=-6,this._overScreen()}this.settings.inViewport}},stop:function(){clearInterval(this._timer),a(window).off("resize").off("scroll")},_overScreen:function(){var t=a(window).scrollTop(),i=a(window).scrollLeft(),s=a(window).width(),e=a(window).height();this.settings.inViewport&&!this.b&&(this.b=!0,this.tip.x-i<0&&("left"==this.position?this.position="right":this.arrowPosition="left"),this.tip.y<t&&("top"==this.position?this.position="bottom":this.arrowPosition="top"),this.tip.y+this.tip.outerHeight()>e+t&&("bottom"==this.position?this.position="top":this.arrowPosition="bottom"),this.tip.x+this.tip.outerWidth()>i+s&&("right"==this.position?this.position="left":this.arrowPosition="right"),this.setPosition(),this.initPos={x:this.tip.x,y:this.tip.y}),this._setPosition()},_setPosition:function(){this.tip.css({left:this.tip.x,top:this.tip.y}),this.tiparrow.css({top:this.tiparrow.y,left:this.tiparrow.x})},setContent:function(t){this.tipcontent.html(t),this.setPosition()}},o});